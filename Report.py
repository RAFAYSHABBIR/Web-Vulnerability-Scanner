
from bs4 import BeautifulSoup 
def finalReport():
    with open("templates/report.html") as fp:
        soup = BeautifulSoup(fp, 'html.parser')
    with open("templates/reportnmap.html") as fp:
      soup1 = BeautifulSoup(fp, 'html.parser')
    textdata = soup1.get_text()
    summary = soup.find_all("table", class_="summary")
    alerts = soup.find_all("table", class_ ="alerts")  
    results = soup.find_all("table", class_="results")
    Function_Name = open("templates/Scan_Report.html","w")

    Function_Name.write(
        """
        <!DOCTYPE html>
    <html>
    <head>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Vulnerability Detector Report</title>
    <style type="text/css">
    body {
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        color: #000;
        font-size: 13px;

    }

    h1 {
        text-align: center;
        font-weight: bold;
        font-size: 32px
    }

    h3 {
        font-size: 16px;
    }

    table {
        border: none;
        font-size: 13px;
    }

    td, th {
        padding: 3px 4px;
        word-break: break-word;
    }

    th {
        font-weight: bold;
        background-color: #666666;
    }

    td {
        background-color: #e8e8e8;
    }

    .spacer {
        margin: 10px;
    }

    .spacer-lg {
        margin: 40px;
    }

    .indent1 {
        padding: 4px 20px;
    }

    .indent2 {
        padding: 4px 40px;
    }

    .risk-3 {
        background-color: black;
        color: #FFF;
    }

    .risk-2 {
        background-color: red;
        color: #FFF;
    }

    .risk-1 {
        background-color: yellow;
        color: #000;
    }

    .risk-0 {
        background-color: blue;
        color: #FFF;
    }

    .risk--1 {
        background-color: green;
        color: #FFF;
    }

    .summary {
        width: 45%;
    }

    .summary th {
        color: #FFF;
    }

    .alerts {
        width: 75%;
    }

    .alerts th {
        color: #FFF;
    }

    .results {
        width: 100%;
    }

    .results th {
        text-align: left;
    }

    .left-header {
        display: inline-block;
    }

    </style>
    </head>
    <body>
    <h1> DIPR Scanning Report </h1>
    <h3 class="left-header">Risk Score</h3>
    """+ str(summary[0]) +"""
    <h3>Web Application Vulnerabilities</h3>
    """ + str(alerts[0]) +"""
    <h3>Network Vulnerabilities</h3>
     <pre style="width: 60vw;">
    """ + 
      str(textdata[0:]) +"""
    <pre style="font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">
    <h3>Vulerabilities Information</h3>
    """ + str(results[0]) +"""
    </body>
    </html>
        """
    )